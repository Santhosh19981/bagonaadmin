<div class="admin-dashboard">
  <!-- SIDEBAR -->
  <app-sidemenu [menuFromParent]="'events'"></app-sidemenu>
  <!-- SIDEBAR -->

  <!-- CONTENT -->
  <section id="content">
    <!-- NAVBAR -->
    <nav>
      <!-- ... Navbar code remains unchanged ... -->
    </nav>
    <!-- NAVBAR -->

    <!-- MAIN -->
    <main>
      <div class="container" *ngIf="showForm">
        <div class="row">
          <div class="col-sm-5">

            <div class="create-header">
              <div class="d-flex justify-content-between align-items-center mb-3">
                <h3 class="m-0">Create Event</h3>

                <button type="button" class="admin-btn btn-soft-danger" (click)="toggleForm()">
                  Back
                </button>
              </div>

              <form class="form-horizontal" (ngSubmit)="saveEvent()">

                <!-- Event Image -->
                <div class="form-group">
                  <label>Event Image</label>
                  <input class="form-control" type="file" accept="image/*" (change)="onImageChange($event)" />
                </div>

                <!-- Event Name -->
                <div class="form-group">
                  <label>Event Name</label>
                  <input type="text" class="form-control" placeholder="Event Name" [(ngModel)]="newEvent.name"
                    name="eventname" required />
                </div>

                <!-- Description -->
                <div class="form-group">
                  <label>Description</label>
                  <input type="text" class="form-control" placeholder="Description" [(ngModel)]="newEvent.description"
                    name="description" />
                </div>

                <!-- Active Switch -->
                <div class="form-group form-check form-switch mt-3 d-flex align-items-center gap-3">
                  <label class="form-check-label mb-1 me-3">Active / Inactive</label>

                  <input type="checkbox" class="form-check-input" role="switch" [checked]="newEvent.status == 'active'"
                    (change)="onToggleChange($event)" />

                </div>


                <!-- Buttons -->
                <button type="button" class="custom-btn btn-7 mt-2 me-2" (click)="toggleForm()">
                  <span>Cancel</span>
                </button>

                <button type="submit" class="custom-btn btn-7 mt-2">
                  <span>Save</span>
                </button>

              </form>
            </div>

          </div>
        </div>
      </div>

      <!-- EVENT LIST TABLE -->
      <!-- Event Table -->
      <div class="table-data" *ngIf="!showForm">

        <!-- When NO events -->

        <!-- When events available -->
        <div class="order">
          <div class="head">
            <h3>Events List</h3>
            <div>
              <a class="admin-btn btn-7 text-decoration-none" (click)="toggleForm()">Add</a>
            </div>
            <form>
              <div class="form-input">
                <input type="search" placeholder="Search..." />
                <button type="submit" class="search-btn">
                  <i class="bx bx-search"></i>
                </button>
              </div>
            </form>
          </div>

          <div class="overflow-auto pr-1 relative h-[calc(100dvh_-_375px)]">
            <table>
              <thead>
                <tr>
                  <th>Image</th>
                  <th>Event Name</th>
                  <th>Description</th>
                  <th>Active</th>
                  <th>Action</th>
                </tr>
              </thead>

              <tbody>
                <ng-container *ngIf="events.length > 0; else noEvents">
                  <tr *ngFor="let event of events">
                    <td>
                      <img [src]="event?.image_url || defaultEventImage" (error)="onImageError($event)" width="50"
                        height="50" class="rounded" />
                    </td>
                    <td>{{ event.name }}</td>
                    <td [title]="event.description">{{ event.description.length > 30 ? (event.description | slice:0:20)
                      + '...' : event.description }}</td>
                    <td>
                      <span class="status"
                        [ngClass]="{'completed': event.status == 'active','pending': event.status !== 'active'}">
                        {{ event.status }}
                      </span>
                    </td>
                    <td>
                      <div class="inline-flex gap-2">
                        <a class="admin-btn btn-soft-primary" (click)="toggleForm(event)">Edit</a>
                        <a class="admin-btn btn-soft-danger" (click)="deleteEvent(event.id)">Delete</a>
                      </div>
                    </td>
                  </tr>
                </ng-container>
                <ng-template #noEvents>
                  <tr>
                    <td colspan="5" class="text-center py-5">
                      <h3>No Events Found</h3>
                      <button class="admin-btn btn-7 mt-3" (click)="toggleForm()">Add Event</button>
                    </td>
                  </tr>
                </ng-template>
              </tbody>
            </table>
          </div>

        </div>

      </div>

    </main>
    <!-- MAIN -->
  </section>
  <!-- CONTENT -->
</div>